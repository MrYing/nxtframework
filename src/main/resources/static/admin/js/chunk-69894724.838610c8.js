(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69894724"],{6669:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.list,(function(t,a){return n("el-tab-pane",{key:a,attrs:{label:t.location_name,name:t.location_name}},[n("bannerSet",{attrs:{bannerList:e.bannerList,location_name:e.activeName}})],1)})),1)],1)},i=[],r=(n("96cf"),n("3b8d")),s=(n("7f7f"),n("ac6a"),n("b775")),c=n("b83f");function l(e){return Object(s["a"])({url:"/api/admin/banner/list",method:"post",data:e})}function o(e){return Object(c["a"])({url:"/api/admin/banner/save",method:"post",data:e})}var u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("vuedraggable",{staticClass:"wrapper",model:{value:e.list,callback:function(t){e.list=t},expression:"list"}},[n("transition-group",e._l(e.list,(function(t,a){return n("div",{key:a,staticClass:"item"},[n("i",{staticClass:"el-icon-close delIcon",on:{click:function(n){return e.deleImg(t,a)}}}),e._v(" "),n("img",{staticStyle:{height:"300px",width:"100%"},attrs:{src:t.banner_picture_url,alt:"",srcset:""}}),e._v(" "),n("div",{staticClass:"link"},[n("span",{staticStyle:{width:"55px"}},[e._v("链接")]),e._v(" "),n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.banner_href_url,callback:function(n){e.$set(t,"banner_href_url",n)},expression:"item.banner_href_url"}})],1)])})),0)],1),e._v(" "),n("el-upload",{attrs:{"show-file-list":!1,action:"","list-type":"picture-card","http-request":e.handleUploadHttpRequest,"on-success":e.handlePictureSuccess}},[n("i",{staticClass:"el-icon-plus"})]),e._v(" "),n("el-button",{staticClass:"buttom",attrs:{plain:""},on:{click:e.handlerSave}},[e._v("更新")])],1)},p=[],h=(n("6b54"),n("c4c8")),f=n("1980"),d=n.n(f),m={name:"bannerSet",components:{vuedraggable:d.a},props:{bannerList:{type:Array,default:function(){return[]}},location_name:{type:String,default:""}},data:function(){return{list:[]}},watch:{bannerList:{handler:function(e,t){this.list=e},immediate:!0}},updated:function(){console.log(this.list)},methods:{handlerSave:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[],n=[],this.list.forEach((function(e){t.push(e.banner_picture_id),n.push(e.banner_href_url)})),a=new FormData,a.append("location_name",this.location_name),a.append("banner_picture_list","["+t.toString()+"]"),a.append("banner_href_list",'["'+n.join('","')+'"]'),e.next=8,o(a);case 8:i=e.sent,0===i.status?this.$notify({title:"提示信息",message:"更新成功",type:"success",duration:2e3}):this.$notify({title:"提示信息",message:response.message,type:"error",duration:2e3});case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleUploadHttpRequest:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.file,a=new FormData,a.append("file",n),e.next=5,Object(h["q"])(a);case 5:i=e.sent,0===i.status?(this.$notify({title:"提示信息",message:"图片上传成功",type:"success",duration:2e3}),r={banner_picture_id:i.id,banner_picture_url:i.url,banner_href_url:""},this.list.push(r),console.log(this.list)):this.$notify({title:"提示信息",message:i.message,type:"error",duration:2e3});case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleImg:function(e,t){this.list.splice(t,1)},handlePictureSuccess:function(e,t,n){var a="image/jpeg"===t.raw.type,i="image/jpg"===t.raw.type,r="image/png"===t.raw.type,s="image/gif"===t.raw.type;if(a||i||r||s){var c=this;new Promise((function(e,n){var a=window.URL||window.webkitURL,i=new Image;i.src=a.createObjectURL(t.raw)})).then((function(){return c.list.push(t.response.data),console.log(c.list),t.raw}))}else this.$message.warning("只支持jpg或png或gif格式图片")}}},b=m,_=(n("eb0e"),n("2877")),g=Object(_["a"])(b,u,p,!1,null,"5ea5af1a",null),v=g.exports,w={components:{bannerSet:v},data:function(){return{list:[],activeName:"",bannerList:[]}},created:function(){this.getList()},methods:{handleClick:function(e,t){var n=this;this.list.forEach((function(t){t.location_name!==e.name||(n.bannerList=t.banner)}))},getList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l({});case 2:t=e.sent,this.list=t.list,this.activeName=this.list[0].location_name,this.bannerList=this.list[0].banner;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},y=w,k=Object(_["a"])(y,a,i,!1,null,null,null);t["default"]=k.exports},eb0e:function(e,t,n){"use strict";n("fa32")},fa32:function(e,t,n){}}]);