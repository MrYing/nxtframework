(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fe923e7"],{"2cb7":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-card",{staticClass:"operatingHints"},[i("el-row",{staticStyle:{"font-weight":"800"}},[e._v("\n      操作提示：\n    ")]),e._v(" "),i("el-row",[e._v("\n      1、系统内置的地区基础数据都可在此修改编辑，请谨慎操作。\n    ")]),e._v(" "),i("el-row",[e._v("\n      2、可以自由添加无限下级、无限量地区。\n    ")]),e._v(" "),i("el-row",[e._v("\n      3、可排序。（注：同级别排序）\n    ")])],1),e._v(" "),i("el-row",{staticStyle:{"margin-top":"30px"}},[i("el-row",{staticStyle:{"font-size":"15px",float:"left","margin-top":"10px","margin-left":"10px","margin-right":"10px"}},[e._v("\n      地区列表\n    ")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("新增地区")])],1),e._v(" "),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("el-table",{ref:"multipleTable",attrs:{data:e.listData,"tooltip-effect":"dark","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":e.handleSelectionChange}},[e._v(">\n      "),i("el-table-column",{attrs:{prop:"regionName",label:"地区",height:"30px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.regionName}},[e._v(e._s(t.row.regionName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"排序",height:"30px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-col",[i("i",{staticClass:"el-icon-bottom",on:{click:function(i){return e.handleSort(t.row,"bot")}}}),e._v(" "),i("i",{staticClass:"el-icon-top",on:{click:function(i){return e.handleSort(t.row,"top")}}})])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"操作","show-overflow-tooltip":"",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small"},on:{click:function(i){return e.editorClick(t.row)}}},[e._v("修改")]),e._v(" "),i("el-button",{attrs:{size:"small"},on:{click:function(i){return e.editorLowerlClick(t.row)}}},[e._v("新增下级")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(i){return e.deleteClick(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"地区管理",visible:e.saveDialog,"close-on-click-modal":!1,"show-close":!1,"close-on-press-escape":!1,width:"450px",center:""},on:{"update:visible":function(t){e.saveDialog=t}}},[i("el-form",{ref:"dialogRef",attrs:{model:e.saveParam,rules:e.saveParamRules}},[i("el-form-item",{attrs:{label:"上级地区",prop:"regionPid","label-width":e.formLabelWidth}},[i("el-select",{attrs:{placeholder:"--请选择--",disabled:e.editorLower},model:{value:e.saveParam.regionPid,callback:function(t){e.$set(e.saveParam,"regionPid",t)},expression:"saveParam.regionPid"}},e._l(e.simpleData,(function(t){return i("el-option",{key:t.region_id,attrs:{label:t.region_name_display,value:t.region_id}},[e._v("\n            "+e._s(t.region_name_display)+"\n          ")])})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"地区名称",prop:"regionName","label-width":e.formLabelWidth}},[i("el-input",{staticStyle:{width:"200px"},model:{value:e.saveParam.regionName,callback:function(t){e.$set(e.saveParam,"regionName",t)},expression:"saveParam.regionName"}})],1)],1),e._v(" "),i("div",{staticStyle:{"margin-left":"120px"}},[i("el-button",{on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveConfirm}},[e._v("确 定")])],1),e._v(" "),i("div",{staticStyle:{"margin-left":"30px","margin-top":"20px",color:"red"}},[e._v("\n      注：地区名称设定直接影响订单、收货地址等重要信息。\n    ")])],1)],1)},n=[],o=(i("c5f6"),i("ac6a"),{data:function(){var e=function(e,t,i){null==t||0===t.length?i(new Error("地区名称不能为空")):i()};return{multipleSelection:[],saveParam:{},saveDialog:!1,saveParamRules:{regionName:[{required:!0,trigger:"blur",validator:e}]},formLabelWidth:"120px",listData:[],hereList:[],simpleData:[],editorLower:!1,pidDataList:{}}},computed:{},created:function(){},mounted:function(){this.load()},methods:{load:function(){var e=this;function t(e,i){for(var a in e)i[a]=e[a].region,null!=i[a].regionPid&&0===i[a].regionPid&&(i[a].regionPid=null),null!=e[a].sub_region_list&&e[a].sub_region_list.length>0&&(i[a].children=[],t(e[a].sub_region_list,i[a].children))}this.$store.dispatch("region/searchListData").then((function(){var i=e.$store.state.region.listData,a=[];t(i,a),e.listData=[],e.listData=a,e.simpleData=[],e.simpleData=e.$store.state.region.simpleData,e.pidDataList={};var n=e;e.simpleData.forEach((function(e){var t=n.pidDataList[e.region_pid];null==t&&(t=[]),t.push(e),n.pidDataList[e.region_pid]=t}))}))},handleSelectionChange:function(e){this.multipleSelection=e},handleSort:function(e,t){var i=this,a=e.regionPid;null==a&&(a=0);var n=0,o=this.pidDataList[a];for(var r in o){var s=Number(r);if(o[s].region_id===e.id){n="top"===t?s-1:s+1;break}}var l=o[n];if(null==l)return!1;this.$store.dispatch("region/swapRegionOrder",{id1:e.id,id2:l.region_id}).then((function(){i.load()}))},handleCreate:function(){this.saveParam={},this.resetForm("dialogRef"),this.saveDialog=!0,this.editorLower=!1},closeDialog:function(){this.saveDialog=!1},saveConfirm:function(){var e=this;this.$refs.dialogRef.validate((function(t){t&&e.saveChange()}))},saveChange:function(){var e=this;this.newParams=Object.assign({},this.saveParam),this.$store.dispatch("region/saveData",this.newParams).then((function(){var t=e.$store.state.region.saveStatus;null!=t&&0===t?(e.$message({type:"success",message:"保存成功"}),e.closeDialog(),e.load()):e.$message({type:"error",message:"保存失败"})}))},editorClick:function(e){this.resetForm("dialogRef"),this.saveDialog=!0,this.editorLower=!1,this.saveParam=Object.assign({},e)},editorLowerlClick:function(e){this.resetForm("dialogRef"),this.saveDialog=!0,this.saveParam={regionPid:e.id},this.editorLower=!0},deleteClick:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=Object.assign({},{id:e.id});t.$store.dispatch("region/deleteData",i).then((function(){var e=t.$store.state.region.deleteStatus;null!=e&&0===e?(t.load(),t.$message({type:"success",message:"删除成功"})):t.$message({type:"error",message:"删除失败"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},resetForm:function(e){null!=this.$refs[e]&&this.$refs[e].resetFields()}}}),r=o,s=(i("30f6"),i("2877")),l=Object(s["a"])(r,a,n,!1,null,null,null);t["default"]=l.exports},"30f6":function(e,t,i){"use strict";i("3ecb")},"3ecb":function(e,t,i){}}]);