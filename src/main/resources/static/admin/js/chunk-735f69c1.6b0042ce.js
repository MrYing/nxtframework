(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-735f69c1"],{"4d93":function(t,e,n){},6669:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},["[]"!==JSON.stringify(t.list)?n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.list,(function(e,a){return n("el-tab-pane",{key:a,attrs:{label:e.location_name,name:e.location_name}},[n("bannerSet",{attrs:{bannerList:t.bannerList,location_name:t.activeName}})],1)})),1):t._e()],1)},i=[],r=(n("96cf"),n("3b8d")),s=(n("7f7f"),n("ac6a"),n("b775")),c=n("b83f");function l(t){return Object(s["a"])({url:"/api/admin/banner/list",method:"post",data:t})}function o(t){return Object(c["a"])({url:"/api/admin/banner/save",method:"post",data:t})}var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vuedraggable",{staticClass:"wrapper",model:{value:t.list,callback:function(e){t.list=e},expression:"list"}},[n("transition-group",t._l(t.list,(function(e,a){return n("div",{key:a,staticClass:"item"},[n("i",{staticClass:"el-icon-close delIcon",on:{click:function(n){return t.deleImg(e,a)}}}),t._v(" "),n("img",{staticStyle:{height:"300px",width:"100%"},attrs:{src:e.banner_picture_url,alt:"",srcset:""}}),t._v(" "),n("div",{staticClass:"link"},[n("span",{staticStyle:{width:"55px"}},[t._v("链接")]),t._v(" "),n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.banner_href_url,callback:function(n){t.$set(e,"banner_href_url",n)},expression:"item.banner_href_url"}})],1)])})),0)],1),t._v(" "),n("el-upload",{attrs:{"show-file-list":!1,action:"","list-type":"picture-card","http-request":t.handleUploadHttpRequest,"on-success":t.handlePictureSuccess}},[n("i",{staticClass:"el-icon-plus"})]),t._v(" "),n("el-button",{staticClass:"buttom",attrs:{plain:""},on:{click:t.handlerSave}},[t._v("更新")])],1)},p=[],h=(n("6b54"),n("c4c8")),d=n("1980"),f=n.n(d),m={name:"bannerSet",components:{vuedraggable:f.a},props:{bannerList:{type:Array,default:function(){return[]}},location_name:{type:String,default:""}},data:function(){return{list:[]}},watch:{bannerList:{handler:function(t,e){this.list=t},immediate:!0}},updated:function(){console.log(this.list)},methods:{handlerSave:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=[],n=[],this.list.forEach((function(t){e.push(t.banner_picture_id),n.push(t.banner_href_url)})),a=new FormData,a.append("location_name",this.location_name),a.append("banner_picture_list","["+e.toString()+"]"),a.append("banner_href_list",'["'+n.join('","')+'"]'),'[""]'==a.get("banner_href_list")&&a.set("banner_href_list","[]"),t.next=9,o(a);case 9:i=t.sent,0===i.status?this.$notify({title:"提示信息",message:"更新成功",type:"success",duration:2e3}):this.$notify({title:"提示信息",message:response.message,type:"error",duration:2e3});case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleUploadHttpRequest:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.file,a=new FormData,a.append("file",n),t.next=5,Object(h["r"])(a);case 5:i=t.sent,0===i.status?(this.$notify({title:"提示信息",message:"图片上传成功",type:"success",duration:2e3}),r={banner_picture_id:i.id,banner_picture_url:i.url,banner_href_url:""},this.list.push(r),console.log(this.list)):this.$notify({title:"提示信息",message:i.message,type:"error",duration:2e3});case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),deleImg:function(t,e){this.list.splice(e,1)},handlePictureSuccess:function(t,e,n){var a="image/jpeg"===e.raw.type,i="image/jpg"===e.raw.type,r="image/png"===e.raw.type,s="image/gif"===e.raw.type;if(a||i||r||s){var c=this;new Promise((function(t,n){var a=window.URL||window.webkitURL,i=new Image;i.src=a.createObjectURL(e.raw)})).then((function(){return c.list.push(e.response.data),console.log(c.list),e.raw}))}else this.$message.warning("只支持jpg或png或gif格式图片")}}},b=m,_=(n("98a1"),n("2877")),g=Object(_["a"])(b,u,p,!1,null,"a5d0d976",null),v=g.exports,w={components:{bannerSet:v},data:function(){return{list:[],activeName:"",bannerList:[]}},created:function(){this.getList()},methods:{handleClick:function(t,e){var n=this;this.list.forEach((function(e){e.location_name!==t.name||(n.bannerList=e.banner)}))},getList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l({});case 2:e=t.sent,this.list=e.list,0!==this.list.length&&(this.activeName=this.list[0].location_name,this.bannerList=this.list[0].banner);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},y=w,k=Object(_["a"])(y,a,i,!1,null,null,null);e["default"]=k.exports},"98a1":function(t,e,n){"use strict";n("4d93")}}]);